<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fretes | NOVA FROTA</title>

  <link rel="stylesheet" href="../assets/css/app.css" />

  <style>
    /* Tela toda, igual ‚Äúplanilha‚Äù */
    body{ overflow:hidden; }

    .fretesWrap{
      height: calc(100vh - 64px);
      padding: 14px 14px 18px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .fretesHeader{
      padding:14px 16px;
    }

    .fretesHeaderTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    .fretesTitle{
      font-weight:900;
      font-size:20px;
      display:flex;
      align-items:center;
      gap:10px;
    }

    .fretesSub{
      color: rgba(233,238,252,.75);
      margin-top:6px;
      font-size:13px;
      line-height:1.35;
    }

    .fretesActions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .btnMini{
      border:1px solid rgba(58,83,168,.95);
      background: linear-gradient(180deg, rgba(27,42,90,.95), rgba(18,30,70,.95));
      color:#e9eefc;
      padding:10px 12px;
      border-radius:14px;
      font-weight:900;
      cursor:pointer;
      font-size:13px;
      white-space:nowrap;
    }
    .btnMini:hover{ filter:brightness(1.08); }

    .btnMini.green{
      border-color: rgba(60,255,160,.45);
      background: linear-gradient(180deg, rgba(14,40,32,.85), rgba(10,24,20,.85));
    }

    .filtersRow{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:10px;
    }

    .inputMini, .selectMini{
      background: rgba(13,20,48,.70);
      border: 1px solid rgba(43,58,114,.95);
      color:#e9eefc;
      border-radius:12px;
      padding:10px 12px;
      outline:none;
      min-width: 220px;
      font-weight:700;
      font-size:13px;
    }
    .selectMini{ min-width: 180px; }

    /* Card da tabela ocupa o resto da tela */
    .tableCard{
      flex:1;
      min-height: 240px;
      padding: 12px 12px 10px;
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }

    /* √Årea rol√°vel tipo Sheets */
    .tableScroller{
      flex:1;
      overflow:auto;
      border: 1px solid rgba(43,58,114,.95);
      border-radius: 12px;
      background: rgba(13,20,48,.45);
    }

    table{
      width: max-content;          /* permite muitas colunas */
      min-width: 100%;             /* mas preenche a tela */
      border-collapse: collapse;
    }

    thead th{
      position: sticky;
      top: 0;
      z-index: 2;
      background: rgba(13,20,48,.96);
      border-bottom: 1px solid rgba(31,43,85,.85);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .05em;
      padding: 10px 10px;
      white-space: nowrap;
    }

    tbody td{
      border-bottom: 1px solid rgba(31,43,85,.55);
      padding: 6px 10px;           /* ‚úÖ linhas mais baixas */
      font-size: 12.5px;
      white-space: nowrap;
    }

    tbody tr:hover{ background: rgba(91,124,250,.10); }

    .num{ text-align:right; font-variant-numeric: tabular-nums; }
    .center{ text-align:center; }

    /* Status estilo ‚Äúp√≠lula‚Äù */
    .statusPill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 4px 10px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 11px;
      letter-spacing:.02em;
      border: 1px solid rgba(255,255,255,.18);
      min-width: 110px;
    }
    .stLIBERADO{ background: rgba(60,255,160,.14); border-color: rgba(60,255,160,.45); }
    .stPARADO{ background: rgba(255,196,0,.14); border-color: rgba(255,196,0,.45); }
    .stSUSPENSO{ background: rgba(255,120,120,.14); border-color: rgba(255,120,120,.45); }

    /* Modal */
    .modal{
      position:fixed; inset:0;
      display:none; align-items:center; justify-content:center;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(6px);
      padding: 18px;
      z-index: 9999;
    }
    .modal.show{ display:flex; }

    .modalCard{
      width: min(980px, 100%);
      max-height: min(86vh, 900px);
      overflow:auto;
      background: linear-gradient(180deg, rgba(17,26,51,.92), rgba(13,20,48,.88));
      border: 1px solid rgba(34,48,94,.95);
      border-radius: 18px;
      padding: 14px;
      box-shadow: 0 18px 45px rgba(0,0,0,.35);
    }

    .modalHead{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin-bottom: 10px;
    }
    .modalTitle{ font-weight: 900; font-size: 16px; margin:0; }

    .formGrid{
      display:grid;
      grid-template-columns: repeat(4, minmax(160px, 1fr));
      gap: 10px;
    }
    @media (max-width: 980px){
      .formGrid{ grid-template-columns: repeat(2, minmax(160px, 1fr)); }
    }
    @media (max-width: 560px){
      .formGrid{ grid-template-columns: 1fr; }
      .inputMini, .selectMini{ min-width: 100%; width: 100%; }
    }

    .field label{
      display:block;
      font-size: 11px;
      opacity:.86;
      margin: 6px 0 6px;
      font-weight: 800;
      letter-spacing:.02em;
      text-transform: uppercase;
    }

    .modalFooter{
      display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap;
      margin-top: 12px;
    }
  </style>
</head>

<body>
  <!-- Topbar do seu sistema -->
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <a class="burger" href="./home.html" title="Voltar"><div></div></a>
        <img src="../assets/img/logo-novafrota.png" alt="NOVA FROTA" />
      </div>
      <div class="actions">
        <div class="icon-btn" title="Sair" data-logout>üë§</div>
      </div>
    </div>
  </div>

  <div class="fretesWrap">
    <div class="card fretesHeader">
      <div class="fretesHeaderTop">
        <div>
          <div class="fretesTitle">üìã Fretes (Operacional)</div>
          <div class="fretesSub">
            Estrutura igual √† planilha: colunas completas e status.<br>
            (Permiss√£o Frete M√≠nimo entra no passo 3, aqui √© a base operacional.)
          </div>
        </div>

        <div class="fretesActions">
          <button class="btnMini green" id="btnNovo">+ Novo Frete</button>
          <button class="btnMini" id="btnExport">Exportar CSV</button>
          <button class="btnMini" id="btnResetDemo" title="Carrega exemplos para visualizar o layout">Resetar Exemplo</button>
        </div>
      </div>

      <div class="filtersRow">
        <input class="inputMini" id="qSearch" placeholder="Buscar (cliente, origem, destino, produto, obs...)" />
        <select class="selectMini" id="qStatus">
          <option value="">Status: Todos</option>
          <option value="LIBERADO">LIBERADO</option>
          <option value="PARADO">PARADO</option>
          <option value="SUSPENSO">SUSPENSO</option>
        </select>
        <input class="inputMini" id="qFilial" placeholder="Filtrar por Filial (opcional)" />
        <input class="inputMini" id="qRegional" placeholder="Filtrar por Regional (opcional)" />
      </div>
    </div>

    <div class="card tableCard">
      <div style="font-weight:900; margin-bottom:10px;">üßæ Tabela de Fretes</div>

      <div class="tableScroller" id="tableScroller">
        <table>
          <thead>
            <tr>
              <th>Regional</th>
              <th>Filial</th>
              <th>Cliente</th>
              <th>Origem</th>
              <th>Coleta</th>
              <th>Contato de embarque</th>
              <th>Destino</th>
              <th>UF</th>
              <th>Descarga</th>
              <th class="num">Volume</th>
              <th class="num">Valor Empresa</th>
              <th class="num">Valor Motorista</th>
              <th class="num">KM</th>
              <th>Produto</th>
              <th>ICMS</th>
              <th>Pedido SAT</th>
              <th class="num">Qtd Porta</th>
              <th class="num">Qtd Tr√¢nsito</th>
              <th class="center">Status</th>
              <th>Observa√ß√µes</th>
            </tr>
          </thead>
          <tbody id="tblBody"></tbody>
        </table>
      </div>

      <div style="margin-top:10px; color: rgba(233,238,252,.72); font-size:12px;">
        Dica: rolagem horizontal funciona como planilha. Linhas est√£o compactas para caber mais na tela.
      </div>
    </div>
  </div>

  <!-- MODAL NOVO/EDITAR -->
  <div class="modal" id="modal">
    <div class="modalCard">
      <div class="modalHead">
        <p class="modalTitle" id="modalTitle">+ Novo Frete</p>
        <button class="btnMini" id="btnCloseModal">Fechar</button>
      </div>

      <div class="formGrid" id="formGrid">
        <!-- campos entram via JS -->
      </div>

      <div class="modalFooter">
        <button class="btnMini" id="btnDelete" style="display:none;">Excluir</button>
        <button class="btnMini green" id="btnSave">Salvar</button>
      </div>
    </div>
  </div>

  <script src="../assets/js/auth.js"></script>
  <script>
    requireHomeAuth();
    bindLogoutButton();
  </script>

  <!-- ‚úÖ seu JS da tela -->
  <script src="../assets/js/fretes.js"></script>
</body>
</html>
